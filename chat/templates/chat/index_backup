<!-- chat/templates/chat/index.html -->
{% extends 'base.html' %}
{% load static %}
{% load thumbnail %}

    
    {% block title %}
        Chat Rooms
    {% endblock title %}
    
    {% block content %}
        
   <div class="container max-w-3xl">
       
   
        
        What chat room would you like to enter?<br>
        <input id="room-name-input" type="text" ><br>
        <input id="room-name-submit" type="button" value="Enter">
        {% for room in rooms.all %}

        
       
            <div class="mx-auto flex   bg-white rounded-lg items-center relative "
                x-data="{
                    comment : false,
                }">
            
            
                <div class="flex flex-col  bg-white shadow-md hover:shodow-lg rounded-2xl w-full h-full ">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center mx-1 md:mx-3">
                            <div class="flex w-16   md:h-24 items-center ml-1 md:ml-5">
                                {{room.id}}
                                {% if request.user.username == room.sender %}
                                    <a href="{% url 'profiles:detail' room.receiver %}" class="object-scale-down">
                                        {% thumbnail room.receiver_profile.profile.image "55x55" crop="center" as img%}
                                            <img src="{{ img.url }}"class="object-scale-down rounded-full border-solid border-white border-2 ">
                                        {% endthumbnail %}
                                    
                                    </a>
                                {% else %}
                                    <a href="{% url 'profiles:detail' room.sender %}" class="object-scale-down">
                                        {% thumbnail room.sender_profile.profile.image "55x55" crop="center" as img %}
                                            <img src="{{ img.url }}"class="object-scale-down rounded-full border-solid border-white border-2">
                                        {% endthumbnail %}
                                        
                                    </a>
                                {% endif %}
                                
                            </div>
                            <div class="flex flex-col">
                                {% if request.user.username == room.sender %}
                                    <a href="{% url 'chat:room' room.receiver %}" class="stretched-link">
                                        <div class="font-medium leading-none uppercase text-sm md:text-base mt-3 font-semibold">{{room.receiver}}</div>
                                    </a>
                                {% else %}
                                    <a href="{% url 'chat:room' room.sender %}" class="stretched-link">
                                        <div class="font-medium leading-none uppercase text-sm md:text-base mt-3 font-semibold">{{room.sender}}</div>
                                    </a>
                                {% endif %}
                                    {% if chats %}
                                    {% for chat in chats reversed %}
                                    
                                    {% if chat.room.id == room.id %}
                                        
                                        
                                        
                                            
                                          
                                            
                                                
                                               
                                                {{forloop.counter}} 
                                                    
                                                    
                                                    {% if chat.is_read == False %}
                                                        
                                                   
                                                            <!-- {{chat.sender.username}}
                                                            {{request.user.username}} -->
                                                            {% if chat.sender.username == request.user.username %}
                                                                <span class="text-gray-500">{{chat.sender}}:{{chat.content}}</span>
                                                            {% else %}
                                                                <span class="font-bold">{{chat.sender}}: {{chat.content}}</span>
                                                            {% endif %}
                                                    {% else %}
                                                            {% if chat.room.sender == request.user.username %}
                                                            
                                                                <span class="">{{chat.room.sender}}:{{chat.content}}</span>
                                                            {% else %}
                                                                <span class="">{{chat.room.receiver}}: {{chat.content}}</span>
                                                            {% endif %}
                                                    {% endif %}
                                                    
                                                
                                                    
                                    
                                            
                                                    
                                        
                                    {% endif %}       
                                    {% endfor %}    
                                    {% endif %}
                            </div>
                        </div>
                        <div class="mx-4 md:mx-1 w-20 md:w-24">
                            <a href="{% url 'profiles:detail' room.receiver %}" class="">
                            <!-- <button  class="bg-blue-500 px-0 md:px-3 py-1 md:py-2 w-full text-xs md:text-sm shadow-sm hover:shadow-lg  border-2 border-blue-500 text-white rounded font-bold">View Profile</button></a> -->
                        </div>
                    </div>
                </div>
            </div>
  
      
    {% endfor %}

   
  
  </div>
    
 {% endblock content %}














 <!-- chat/templates/chat/index.html -->
{% extends 'base.html' %}
{% load static %}
{% load thumbnail %}

    
    {% block title %}
        Chat Rooms
    {% endblock title %}
    
    {% block content %}
        
   <div class="container max-w-3xl">
       
   
        
        What chat room would you like to enter?<br>
        <input id="room-name-input" type="text" ><br>
        <input id="room-name-submit" type="button" value="Enter">
        {{request.user}}
        {% for room in rooms.all %}

        <div class="row mb-3">
            <div class="card col-md-12 p-5 shadow-sm">
               
                
                    
                {% if request.user.username == room.sender %}
                    <a href="{% url 'chat:room' room.receiver %}" class="stretched-link"></a><h5>{{ room.sender }} - {{ room.receiver }}</h5></a>
                {% else %}
                    <a href="{% url 'chat:room' room.sender %}" class="stretched-link"></a><h5>{{ room.sender }} - {{ room.receiver }}</h5></a>
                {% endif %}
                    
                     
                     
                        
                        {% for chat in chats %}
                                
                            {% if chat.room.id == room.id %}
                          
                               
                               
                                    {{chat.is_read}}
                                    {% if chat.is_read == False %}
                                        
                                        {{chat.sender}}
                                            {{forloop.counter}}
                                            
                                            {% if chat.sender == request.user %}
                                                <span class="">{{chat.sender}}:{{chat.content}}</span>
                                            {% else %}
                                            <span class="font-bold">{{chat.sender}}:{{chat.content}}</span>
                                            {% endif %}    
                                    {% else %}
                                        {{chat.sender}}:{{chat.content}}
                                    {% endif %}
                                    <a href=""><button class="btn btn-primary">See Message</button></a>  
                                    
                               
                              
                               
                                 
                             {% endif %}
                        
                               
                        {% endfor %}
                            
                     
                         
             
            </div>
        </div>
        
    {% endfor %}

   
  
  </div>
    
 {% endblock content %}
